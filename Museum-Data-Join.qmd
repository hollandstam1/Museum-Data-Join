---
title: "Museum Data Join"
name: "Holland Stam"
date: "02.01.2022"
---

```{r load-pkg-data}
#| message: false
library(tidyverse)
library(tidymodels)
library(knitr)

gardner <- read_csv("data/gardner.csv")
#loadjanson
janson <- read_csv("data/janson.csv")
#loadMoMA
moma <- read_csv("data/moma.csv")
#loadCountMoMAExh
countmoma <- read_csv("data/countmoma.csv")
#loadWhitney
whitney <- read_csv("data/whitney.csv")
```

join gardner and janson with column = book, janson, gardner

```{r janson}
janson <- janson %>%
    mutate(ArtistNationalityOther = 
             case_when((ArtistNationality != "French") &
                       (ArtistNationality != "American") &
                       (ArtistNationality != "German") &
                       (ArtistNationality != "Spanish") &
                       (ArtistNationality != "British") 
                                          ~ "Other",
             (ArtistNationality == "French" ~ "French"),
             (ArtistNationality == "British" ~ "British"),
             (ArtistNationality == "American" ~ "American"),
             (ArtistNationality == "Spanish" ~ "Spanish"),
             (ArtistNationality == "German" ~ "German"))) %>%
  select("ArtistName", 
        "EditionNumber",
<<<<<<< HEAD
        "Year", 
=======
        "YearofPublication", 
>>>>>>> 08426c4e468ab96beb889994bc8571cfd2a48231
        "ArtistUniqueID", 
        "ArtistNationality",
        "ArtistNationalityOther",
        "ArtistGender", 
        "ArtistRace", 
        "ArtistEthnicity", 
        "Book", 
        "SpaceRatioPerPage")
```

```{r gardner}
gardner <- gardner %>%
    mutate(ArtistNationalityOther = 
             case_when((ArtistNationality != "French") &
                       (ArtistNationality != "American") &
                       (ArtistNationality != "German") &
                       (ArtistNationality != "Spanish") &
                       (ArtistNationality != "British") 
                                          ~ "Other",
             (ArtistNationality == "French" ~ "French"),
             (ArtistNationality == "British" ~ "British"),
             (ArtistNationality == "American" ~ "American"),
             (ArtistNationality == "Spanish" ~ "Spanish"),
             (ArtistNationality == "German" ~ "German"))) %>%
  select("ArtistName", 
        "EditionNumber",
<<<<<<< HEAD
        "Year", 
=======
        "YearofPublication", 
>>>>>>> 08426c4e468ab96beb889994bc8571cfd2a48231
        "ArtistUniqueID", 
        "ArtistNationality",
        "ArtistNationalityOther",
        "ArtistGender", 
        "ArtistRace", 
        "ArtistEthnicity", 
        "Book", 
        "SpaceRatioPerPage")
```

```{r gardnerjanson}
gardnerjanson <- gardner %>%
  full_join(janson, by = c("ArtistName", 
                           "EditionNumber",
<<<<<<< HEAD
                           "Year", 
=======
                           "YearofPublication", 
>>>>>>> 08426c4e468ab96beb889994bc8571cfd2a48231
                           "ArtistUniqueID", 
                           "ArtistNationality", 
                           "ArtistNationalityOther",
                           "ArtistGender", 
                           "ArtistRace", 
                           "ArtistEthnicity", 
                           "Book", 
                           "SpaceRatioPerPage")) %>%
  select("ArtistName", 
        "EditionNumber",
<<<<<<< HEAD
        "Year", 
=======
        "YearofPublication", 
>>>>>>> 08426c4e468ab96beb889994bc8571cfd2a48231
        "ArtistUniqueID", 
        "ArtistNationality",
        "ArtistNationalityOther",
        "ArtistGender", 
        "ArtistRace", 
        "ArtistEthnicity", 
        "Book", 
        "SpaceRatioPerPage")

```

countmomacleanNA

```{r countmomaclean}
countmoma <- countmoma %>%
  filter(`TotalAreaText(cm^2)`!= "NA")

```

join gardnerjanson with MoMA through antijoin - showing gardnerjanson that is NOT in MoMA - compare directly with moma?

```{r momaantijoin}
antimomagardnerjanson <- gardnerjanson %>%
  anti_join(moma)

```

clean artist name manually using gardnerjanson name

```{r whitneyantijoin}
antiwhitneygardnerjanson <- gardnerjanson %>%
  anti_join(whitney)

```

join gardnerjansonMoMa with Whitney through antijoin

<<<<<<< HEAD
arrange(ArtistName, EndYear)%>%

group_by(ArtistName)%>%

mutate(count_to_date = cumsum(count))%>%

select(ArtistName, count_to_date)

```{r momaexh}
moma <- moma %>%
  mutate(count = 1)%>%
  arrange(ArtistName, Year)%>%
  group_by(ArtistName)%>%
  mutate(count_to_date = cumsum(count))%>%
  select(ArtistName, count_to_date, Year)
=======
```{r momaexh}
moma <- moma %>%
  mutate(count = 1)%>%
  arrange(ArtistName, EndYear)%>%
  group_by(ArtistName)%>%
  mutate(count_to_date = cumsum(count))%>%
  select(ArtistName, count_to_date)
>>>>>>> 08426c4e468ab96beb889994bc8571cfd2a48231
```

```{r momagarderjanson}
momagardnerjanson <- gardnerjanson %>%
<<<<<<< HEAD
  inner_join(moma, by = "ArtistName", "Year.x")
=======
  right_join(moma)
>>>>>>> 08426c4e468ab96beb889994bc8571cfd2a48231

```

```{r whitneyexh}
whitney <- whitney %>%
  mutate(count = 1)%>%
  arrange(ArtistName, EndYear)%>%
  group_by(ArtistName)%>%
  mutate(count_to_date = cumsum(count))%>%
  select(ArtistName, count_to_date)

```

```{r whitneygardnerjanson}
whitneygardnerjanson <- gardnerjanson %>%
  right_join(whitney)

```

EDA: Bivariate Plots and MLR with SpaceRatio

Janson:

```{r countjanson}
ggplot(janson, aes(x = SpaceRatioPerPage, fill = EditionNumber))+
  geom_histogram()+
  labs(title = "Distribution of Ratio of Space 
       per Artist per Edition per Page in Janson",
       x = "Ratio of Space per Page",
       y = "Count")

summary(janson$SpaceRatioPerPage)

<<<<<<< HEAD
```

The visualization above is right skewed, unimodal and assymetrical. Therefore, we would want to look at the median and IQR. The median of `SpaceRatioPerPage` in Janson is `median`
=======
median(janson$SpaceRatioPerPage)%>%
  pull()

```

The visualization above is right skewed, unimodal and assymetrical. Therefore, we would want to look at the median and IQR. The median of `SpaceRatioPerPage` in Janson is `r median`
>>>>>>> 08426c4e468ab96beb889994bc8571cfd2a48231

SpaceRatioPerPage with Gender

```{r genderjanson}
ggplot(janson, aes(x=ArtistGender, y= SpaceRatioPerPage))+
  geom_boxplot()+
  labs(title = "Ratio of Space per Page per Artist per Edition in 
       Janson by Gender",
       x = "Gender",
       y = "Ratio of Space per Page")

```

SpaceRatioPerPage with Race

```{r racejanson}
ggplot(janson, aes(x=ArtistRace, y= SpaceRatioPerPage))+
  geom_boxplot()+
  labs(title = "Ratio of Space per Page per Artist per Edition in 
       Janson by Race",
       x = "Race",
       y = "Ratio of Space per Page")

```

SpaceRatioPerPage with Ethnicity

```{r jansonethnicity}
ggplot(janson, aes(x=ArtistEthnicity, y= SpaceRatioPerPage))+
  geom_boxplot()+
  labs(title = "Ratio of Space per Page per Artist per Edition in
       Janson by Ethnicity",
       x = "Ethnicity",
       y = "Ratio of Space per Page")
```

SpaceRatioPerPage with Nationality

```{r jansonnationality}
ggplot(janson, aes(x=ArtistNationalityOther, y= SpaceRatioPerPage))+
  geom_boxplot()+
  labs(title = "Ratio of Space per Page per Artist per Edition in 
       Janson by Nationality",
       x = "Nationality",
       y = "Ratio of Space per Page")
```

MLR of Janson with Gender +Race + Nationality + Ethnicity \~ SpaceRatioPerPage

```{r jansonMLR}
jansonMLR = lm(SpaceRatioPerPage ~ ArtistRace + 
                         ArtistEthnicity + 
                         ArtistGender +
                         ArtistNationalityOther, 
                       data = janson)
summary(jansonMLR)

```

```{r jansonrsquared}
glance(jansonMLR)$r.squared

```

Gardner:

```{r countgardner}
ggplot(gardner, aes(x = SpaceRatioPerPage))+
  geom_histogram()+
  labs(title = "Distribution of Ratio of Space 
       per Artist per Edition per Page in Gardner",
       x = "Ratio of Space per Page",
       y = "Count")

summary(gardner$SpaceRatioPerPage)
```

SpaceRatioPerPage vs Gender

```{r gardnergender}
ggplot(gardner, aes(x=ArtistGender, y= SpaceRatioPerPage))+
  geom_boxplot()+
  labs(title = "Ratio of Space per Page per Artist per Edition in 
<<<<<<< HEAD
       Gardner by Gender",
=======
       Garder by Gender",
>>>>>>> 08426c4e468ab96beb889994bc8571cfd2a48231
       x = "Gender",
       y = "Ratio of Space per Page")

```

SpaceRatioPerPage vs Race

```{r gardnerrace}
ggplot(gardner, aes(x=ArtistRace, y= SpaceRatioPerPage))+
  geom_boxplot()+
  labs(title = "Ratio of Space per Page per Artist per Edition in 
       Gardner by Race",
       x = "Race",
       y = "Ratio of Space per Page")+
   theme(axis.text.x = element_text(angle = 45, size = 5))+
  ylim(0, 2.0)
```

SpaceRatioPerPage vs Ethnicity

```{r gardnerethnicity}
ggplot(gardner, aes(x=ArtistEthnicity, y= SpaceRatioPerPage))+
  geom_boxplot()+
  labs(title = "Ratio of Space per Page per Artist per Edition in 
       Gardner by Ethnicity",
       x = "Ethnicity",
       y = "Ratio of Space per Page")
```

SpaceRatioPerPage vs Nationality

```{r gardnernationality}
ggplot(gardner, aes(x=ArtistNationalityOther, y= SpaceRatioPerPage))+
  geom_boxplot()+
  labs(title = "Ratio of Space per Page per Artist per Edition in 
       Gardner by Nationality",
       x = "Nationality",
       y = "Ratio of Space per Page")

```

GardnerMLR Demographic

```{r gardnerMLR}
gardnerMLR = lm(SpaceRatioPerPage ~ ArtistRace + 
                         ArtistEthnicity + 
                         ArtistGender +
                         ArtistNationalityOther, 
                       data = gardner)
summary(gardnerMLR)

```

```{r gardnerrsquared}
glance(gardnerMLR)$r.squared

```

MLR demograpic with jansongardner

```{r gardnerjansonMLR}
gardnerjansonMLR = lm(SpaceRatioPerPage ~ ArtistRace + 
                         ArtistEthnicity + 
                         ArtistGender +
                         ArtistNationalityOther, 
                       data = gardnerjanson)
summary(gardnerjansonMLR)
```

```{r gardnerjansonrsquared}
glance(gardnerjansonMLR)$r.squared

```

whitney eda

<<<<<<< HEAD
```{r whitneycounttodate}
ggplot(whitneygardnerjanson, aes(x = count_to_date))+
  geom_histogram()+
  labs(title = "Distribution of Whitney Exhibitions per Artist per Edition",
       x = "Count to Date",
       y = "Count")

```

```{r whitneyvisual}
ggplot(whitneygardnerjanson, aes(x = count_to_date, y = SpaceRatioPerPage))+
  geom_point()+
  labs(title = "Ratio of Space Per Artist Per Edition by 
       Number of Exhibitions per Artist per Editions in the Whitney", 
       x = "Count to Date",
       y = "Ratio of Space Per Artist Per Edition")
=======
```{r whitneyeda}
ggplot(whitneygardnerjanson, aes(x = count_to_date, y = SpaceRatioPerPage))+
  geom_point()
>>>>>>> 08426c4e468ab96beb889994bc8571cfd2a48231
```

moma eda

<<<<<<< HEAD
```{r momacounttodate}
ggplot(momagardnerjanson, aes(x = count_to_date))+
  geom_histogram()+
  labs(title = "Distribution of MoMA Exhibitions per Artist per Edition",
       x = "Count to Date",
       y = "Count")
```

```{r momavisual}
ggplot(momagardnerjanson, aes(x = count_to_date, y = SpaceRatioPerPage))+
  geom_point()+
  labs(title = "Ratio of Space Per Artist Per Edition by 
       Number of Exhibitions per Artist per Editions in the MoMA", 
       x = "Count to Date",
       y = "Ratio of Space Per Artist Per Edition")
=======
```{r momaeda}
ggplot(momagardnerjanson, aes(x = count_to_date, y = SpaceRatioPerPage))+
  geom_point()
>>>>>>> 08426c4e468ab96beb889994bc8571cfd2a48231
```
