---
title: "Museum Data Join"
name: "Holland Stam"
date: "02.01.2022"
---

```{r load-pkg-data}
#| message: false
library(tidyverse)
library(tidymodels)
library(knitr)

gardner <- read_csv("data/gardner.csv")
#loadjanson
janson <- read_csv("data/janson.csv")
#loadMoMA
moma <- read_csv("data/moma.csv")
#loadCountMoMAExh
countmoma <- read_csv("data/countmoma.csv")
#loadWhitney
whitney <- read_csv("data/whitney.csv")
```

join gardner and janson with column = book, janson, gardner

```{r janson}
janson <- janson %>%
    mutate(ArtistNationalityOther = 
             case_when((ArtistNationality != "French") &
                       (ArtistNationality != "American") &
                       (ArtistNationality != "German") &
                       (ArtistNationality != "Spanish") &
                       (ArtistNationality != "British") 
                                          ~ "Other",
             (ArtistNationality == "French" ~ "French"),
             (ArtistNationality == "British" ~ "British"),
             (ArtistNationality == "American" ~ "American"),
             (ArtistNationality == "Spanish" ~ "Spanish"),
             (ArtistNationality == "German" ~ "German"))) %>%
  group_by(ArtistName, 
        EditionNumber,
        Year,
        ArtistNationalityOther,
        ArtistGender, 
        ArtistRace, 
        ArtistEthnicity, 
        Book)%>%
  summarise(SpaceRatioPerPage = sum(SpaceRatioPerPage))
```

```{r gardner}
gardner <- gardner %>%
    mutate(ArtistNationalityOther = 
             case_when((ArtistNationality != "French") &
                       (ArtistNationality != "American") &
                       (ArtistNationality != "German") &
                       (ArtistNationality != "Spanish") &
                       (ArtistNationality != "British") 
                                          ~ "Other",
             (ArtistNationality == "French" ~ "French"),
             (ArtistNationality == "British" ~ "British"),
             (ArtistNationality == "American" ~ "American"),
             (ArtistNationality == "Spanish" ~ "Spanish"),
             (ArtistNationality == "German" ~ "German"))) %>%
  group_by(ArtistName, 
        EditionNumber,
        Year,
        ArtistNationalityOther,
        ArtistGender, 
        ArtistRace, 
        ArtistEthnicity, 
        Book)%>%
  summarise(SpaceRatioPerPage = sum(SpaceRatioPerPage))
```

```{r gardnerjanson}
gardnerjanson <- gardner %>%
  full_join(janson, by = c("ArtistName", 
                           "EditionNumber",
                           "Year",
                           "ArtistNationalityOther",
                           "ArtistGender", 
                           "ArtistRace", 
                           "ArtistEthnicity", 
                           "Book", 
                           "SpaceRatioPerPage"))
```

countmomacleanNA

```{r countmomaclean}
countmoma <- countmoma %>%
  filter(`TotalAreaText(cm^2)`!= "NA")

```

join gardnerjanson with MoMA through antijoin - showing gardnerjanson that is NOT in MoMA - compare directly with moma?

```{r momaantijoin}
antimomagardnerjanson <- gardnerjanson %>%
  anti_join(moma)

```

clean artist name manually using gardnerjanson name

```{r whitneyantijoin}
antiwhitneygardnerjanson <- gardnerjanson %>%
  anti_join(whitney)

```

join gardnerjansonMoMa with Whitney through antijoin

arrange(ArtistName, EndYear)%>%

group_by(ArtistName)%>%

mutate(count_to_date = cumsum(count))%>%

select(ArtistName, count_to_date)

```{r momaexh}
moma <- moma %>%
  mutate(count = 1)%>%
  arrange(ArtistName, Year)%>%
  group_by(ArtistName)
```

```{r momagarderjanson}
momagardnerjanson <- gardnerjanson %>%
  left_join(moma, by = "ArtistName", "Year")

```

```{r whitneyexh}
whitney <- whitney %>%
  mutate(count = 1)%>%
  arrange(ArtistName, Year)%>%
  group_by(ArtistName)%>%
  mutate(count_to_date = cumsum(count))%>%
  select(ArtistName, count_to_date)
```

```{r whitneygardnerjanson}
whitneygardnerjanson <- gardnerjanson %>%
  right_join(whitney)

```

EDA: Bivariate Plots and MLR with SpaceRatio

Janson:

```{r countjanson}
ggplot(janson, aes(x = SpaceRatioPerPage, fill = EditionNumber))+
  geom_histogram()+
  labs(title = "Distribution of Ratio of Space 
       per Artist per Edition per Page in Janson",
       x = "Ratio of Space per Page",
       y = "Count")

summary(janson$SpaceRatioPerPage)

median(janson$SpaceRatioPerPage)

IQR(janson$SpaceRatioPerPage)

janson%>%
  arrange(desc(SpaceRatioPerPage))%>%
  select(ArtistName, EditionNumber, Year, SpaceRatioPerPage)%>%
  filter(SpaceRatioPerPage >= 2)
```

The visualization above is right skewed, unimodal and assymetrical. Therefore, we would want to look at the median to understand its center and IQR to understand its spread. The median of `SpaceRatioPerPage` in Janson is `r round(median(janson$SpaceRatioPerPage), 3)` and the IQR is `r round(IQR(janson$SpaceRatioPerPage), 3)`. There are potential outliers that are over 2.0, meaning the amount of space, area of text and area of figure in text combined is more than just the area of a single page within the respective book of *Janson's History of Art.* It is obvious to observe that Spanish painter, Pablo Picasso dominates space through all editions of Janson.

```{r genderjanson}
ggplot(janson, aes(x=ArtistGender, y= SpaceRatioPerPage))+
  geom_boxplot()+
  labs(title = "Ratio of Space per Page per Artist per Edition in 
       Janson by Gender",
       x = "Gender",
       y = "Ratio of Space per Page")

janson_female <- janson %>%
  filter(ArtistGender == "Female")

janson_female %>%
  filter(SpaceRatioPerPage > .63)%>%
  select(ArtistName, ArtistGender, EditionNumber, Year, SpaceRatioPerPage)%>%
  arrange(desc(SpaceRatioPerPage))

median(janson_female$SpaceRatioPerPage)

janson_male <- janson %>%
  filter(ArtistGender == "Male")

median(janson_male$SpaceRatioPerPage)

```

Interestingly enough, the median `SpaceRatioPerPage` for female artists is `r round(median(janson_female$SpaceRatioPerPage), 3)`, not far below the median `SpaceRatioPerPage` for male artists, `r round(median(janson_male$SpaceRatioPerPage), 3)` in *Janson's History of Art.* This indicates that even though the number of female artists per edition included is far fewer, `r nrow(janson_female)`, the median amount of space given to women is similar to that as the median amount of space given to male artists per edition, `r nrow(janson_male)`. The only female artist that comes close to being larger than 1 for SpaceRatioPerPage is Hannah Hoch, as seen by the table above.

```{r racejanson}
ggplot(janson, aes(x=ArtistRace, y= SpaceRatioPerPage))+
  geom_boxplot()+
  labs(title = "Ratio of Space per Page per Artist per Edition in 
       Janson by Race",
       x = "Race",
       y = "Ratio of Space per Page")

janson %>%
  filter(ArtistRace == "American Indian or Alaska Native")%>%
  select(ArtistName, 
         ArtistGender, 
         ArtistRace, 
         EditionNumber, 
         Year, 
         SpaceRatioPerPage)

janson %>%
  filter(ArtistRace == "Asian")%>%
  select(ArtistName, 
         ArtistGender, 
         ArtistRace, 
         EditionNumber, 
         Year, 
         SpaceRatioPerPage)

janson %>%
  filter(ArtistRace == "Black or African American")%>%
  select(ArtistName, 
         ArtistGender, 
         ArtistRace, 
         EditionNumber, 
         Year, 
         SpaceRatioPerPage)%>%
  filter(SpaceRatioPerPage > .75)

janson_white <- janson%>%
  filter(ArtistRace == "White")%>%
  arrange(desc(SpaceRatioPerPage))

```

Regarding race, there is only artist for American Indian or Alaska Native, which is Kay Walkingstick in the 5th and 6th Editions and one artist for Asian, Ando Hiroshige in the 7th and 8th Editions. Additionally, there is only one Black or African American artist who has a `SpaceRatioPerPage` that is over .75, William T. Williams in the 3rd Edition. There are myriad white artists per work per edition, `r nrow(janson_white)`, and their space trumps that of the space allotted to nonwhite artists.

```{r jansonethnicity}
ggplot(janson, aes(x=ArtistEthnicity, y= SpaceRatioPerPage))+
  geom_boxplot()+
  labs(title = "Ratio of Space per Page per Artist per Edition in
       Janson by Ethnicity",
       x = "Ethnicity",
       y = "Ratio of Space per Page")

janson_HL <- janson %>%
  filter(ArtistEthnicity == "Hispanic or Latinx")

median(janson_HL$SpaceRatioPerPage)

janson_NHL <- janson %>%
  filter(ArtistEthnicity == "Not Hispanic or Latinx")

median(janson_NHL$SpaceRatioPerPage)


```

Interestingly, the median `SpaceRatioPerPage` for artists who are Hispanic or Latinx, `r round(median(janson_HL$SpaceRatioPerPage), 3)` is higher than those who are Not Hispanic or Latinx, `r round(median(janson_NHL$SpaceRatioPerPage), 3)`. There are `r nrow(janson_HL)` observations of artists per edition who are Hispanic and Latinx and there are `r nrow(janson_NHL)` observations of artists per edition who are not Hispanic or Latinx. Picasso plays a large role in such, as he is Hispanic or Latinx and is accounting for the outlyingly larger observations for `SpaceRatioPerPage`.

```{r jansonnationality}
ggplot(janson, aes(x=ArtistNationalityOther, y= SpaceRatioPerPage))+
  geom_boxplot()+
  labs(title = "Ratio of Space per Page per Artist per Edition in 
       Janson by Nationality",
       x = "Nationality",
       y = "Ratio of Space per Page")
```

MLR of Janson with Gender +Race + Nationality + Ethnicity \~ SpaceRatioPerPage

STILL NEED TO ACCOUNT OF RANDOM EFFECT OF ARTIST

```{r jansonMLR}
jansonMLR = lm(SpaceRatioPerPage ~ ArtistRace + 
                         ArtistEthnicity + 
                         ArtistGender +
                         ArtistNationalityOther, 
                       data = janson)
summary(jansonMLR)

```

```{r jansonrsquared}
glance(jansonMLR)$r.squared

```

Gardner:

```{r countgardner}
ggplot(gardner, aes(x = SpaceRatioPerPage))+
  geom_histogram()+
  labs(title = "Distribution of Ratio of Space 
       per Artist per Edition per Page in Gardner",
       x = "Ratio of Space per Page",
       y = "Count")

summary(gardner$SpaceRatioPerPage)

median(gardner$SpaceRatioPerPage)

IQR(gardner$SpaceRatioPerPage)

gardner%>%
  arrange(desc(SpaceRatioPerPage))%>%
  select(ArtistName, EditionNumber, Year, SpaceRatioPerPage)%>%
  filter(SpaceRatioPerPage >= 2)
```

The visualization above is right skewed, unimodal and assymetrical. Therefore, we would want to look at the median to understand its center and IQR to understand its spread. The median of `SpaceRatioPerPage` in Gardner is `r round(median(gardner$SpaceRatioPerPage), 3)` and the IQR is `r round(IQR(gardner$SpaceRatioPerPage), 3)`. There are potential outliers that are over 2.0, meaning the amount of space, area of text and area of figure in text combined is more than just the area of a single page within the respective book of *Gardner's Art Through the Ages.* It is obvious to observe that Spanish painter, Pablo Picasso dominates space through Gardner's, similarly as he did in *Janson's History of Art,* but he has more company this time around. French painters such as Delacroix and Jacques-Louis David also occupy substantial space, particularly in the 10th edition.

```{r gardnergender}
ggplot(gardner, aes(x=ArtistGender, y= SpaceRatioPerPage))+
  geom_boxplot()+
  labs(title = "Ratio of Space per Page per Artist per Edition in 
       Gardner by Gender",
       x = "Gender",
       y = "Ratio of Space per Page")

gardner_female <- gardner %>%
  filter(ArtistGender == "Female")

gardner_female %>%
  filter(SpaceRatioPerPage > .6)%>%
  select(ArtistName, ArtistGender, EditionNumber, Year, SpaceRatioPerPage)%>%
  arrange(desc(SpaceRatioPerPage))

median(gardner_female$SpaceRatioPerPage)

gardner_male <- gardner %>%
  filter(ArtistGender == "Male")

median(gardner_male$SpaceRatioPerPage)

gardner_male1 <- gardner_male %>%
  filter(SpaceRatioPerPage > 1)%>%
  select(ArtistName, 
         ArtistGender, 
         EditionNumber, 
         Year, 
         SpaceRatioPerPage)%>%
  arrange(desc(SpaceRatioPerPage))

gardner_NAgender <- gardner %>%
  filter(ArtistGender == "N/A")

median(gardner_NAgender$SpaceRatioPerPage)
```

The median `SpaceRatioPerPage` for female artists is `r round(median(janson_female$SpaceRatioPerPage), 3)` is below the median for artists whose gender is unknown, `r median(gardner_NAgender$SpaceRatioPerPage)`, as well as the median for male artists `r round(median(gardner_male$SpaceRatioPerPage), 3)` in *Gardner's Art Through the Ages.* The number of artists whose gender is unknown has the fewest observations, `r nrow(gardner_NAgender)`, the number of female artists is slightly greater, `r nrow(gardner_female)`, and the amount of male artists through editions is, `r nrow(gardner_male)`. The only female artist that comes close to being larger than 1 for `SpaceRatioPerPage` is again Hannah Hoch, as seen by the table above. Male artists have a dramatic amount of outlying artists through editions over a `SpaceRatioPerPage` of 1, `r nrow(gardner_male1)`.

```{r gardnerrace}
ggplot(gardner, aes(x=ArtistRace, y= SpaceRatioPerPage))+
  geom_boxplot()+
  labs(title = "Ratio of Space per Page per Artist per Edition in 
       Gardner by Race",
       x = "Race",
       y = "Ratio of Space per Page")+
   theme(axis.text.x = element_text(angle = 45, size = 5))+
  ylim(0, 2.0)
```

What sticks out like a sore thumb in the visualization above is the significant number of outlying white artists.

```{r gardnerethnicity}
ggplot(gardner, aes(x=ArtistEthnicity, y= SpaceRatioPerPage))+
  geom_boxplot()+
  labs(title = "Ratio of Space per Page per Artist per Edition in 
       Gardner by Ethnicity",
       x = "Ethnicity",
       y = "Ratio of Space per Page")
```

Across all three categories, Hispanic or Latinx, Not Hispanic or Latinx and N/A, the medians remain relatively similar. The tail for Hispanic or Latinx are comparable to the tail for Not Hispanic or Latinx, just simply the number of observations are far fewer.

```{r gardnernationality}
ggplot(gardner, aes(x=ArtistNationalityOther, y= SpaceRatioPerPage))+
  geom_boxplot()+
  labs(title = "Ratio of Space per Page per Artist per Edition in 
       Gardner by Nationality",
       x = "Nationality",
       y = "Ratio of Space per Page")

```

GardnerMLR Demographic

```{r gardnerMLR}
gardnerMLR = lm(SpaceRatioPerPage ~ ArtistRace + 
                         ArtistEthnicity + 
                         ArtistGender +
                         ArtistNationalityOther, 
                       data = gardner)
summary(gardnerMLR)

```

```{r gardnerrsquared}
glance(gardnerMLR)$r.squared

```

MLR demograpic with jansongardner

```{r gardnerjansonMLR}
gardnerjansonMLR = lm(SpaceRatioPerPage ~ ArtistRace + 
                         ArtistEthnicity + 
                         ArtistGender +
                         ArtistNationalityOther, 
                       data = gardnerjanson)
summary(gardnerjansonMLR)
```

```{r gardnerjansonrsquared}
glance(gardnerjansonMLR)$r.squared

```

whitney eda

{r whitneycounttodate} ggplot(whitneygardnerjanson, aes(x = count_to_date))+ geom_histogram()+ labs(title = "Distribution of Whitney Exhibitions per Artist per Edition", x = "Count to Date", y = "Count")

{r whitneyvisual} ggplot(whitneygardnerjanson, aes(x = count_to_date, y = SpaceRatioPerPage))+ geom_point()+ labs(title = "Ratio of Space Per Artist Per Edition by Number of Exhibitions per Artist per Editions in the Whitney", x = "Count to Date", y = "Ratio of Space Per Artist Per Edition")

moma eda

{r momacounttodate} ggplot(momagardnerjanson, aes(x = count_to_date))+ geom_histogram()+ labs(title = "Distribution of MoMA Exhibitions per Artist per Edition", x = "Count to Date", y = "Count")

{r momavisual} ggplot(momagardnerjanson, aes(x = count_to_date, y = SpaceRatioPerPage))+ geom_point()+ labs(title = "Ratio of Space Per Artist Per Edition by Number of Exhibitions per Artist per Editions in the MoMA", x = "Count to Date", y = "Ratio of Space Per Artist Per Edition")
